html <!DOCTYPE html>

<html lang="zh"> <head> <meta charset="UTF-8"> <meta name="viewport" content="width=device-width, initial-scale=1.0"> <title>Cookie 数据加密工具</title> <style> body { font-family: Arial, sans-serif; line-height: 1.6; margin: 0; padding: 20px; color: #333; max-width: 800px; margin: 0 auto; }
    .container {
        background-color: #f9f9f9;
        border-radius: 8px;
        padding: 20px;
        box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
    }

    h1, h2 {
        color: #1a73e8;
    }

    .file-input-section {
        margin-top: 20px;
    }

    .result-section {
        margin-top: 30px;
    }

    textarea {
        width: 100%;
        height: 200px;
        padding: 10px;
        border: 1px solid #ddd;
        border-radius: 4px;
        margin-top: 10px;
        font-family: monospace;
        font-size: 13px;
    }

    button {
        background-color: #1a73e8;
        color: white;
        border: none;
        padding: 10px 20px;
        border-radius: 4px;
        cursor: pointer;
        font-size: 15px;
        margin-top: 10px;
    }

    button:hover {
        background-color: #0d62c9;
    }

    .success-message {
        background-color: #d9f7be;
        color: #389e0d;
        padding: 10px;
        border-radius: 4px;
        margin-top: 10px;
        display: none;
    }

    .error-message {
        background-color: #ffccc7;
        color: #cf1322;
        padding: 10px;
        border-radius: 4px;
        margin-top: 10px;
        display: none;
    }

    .helper-text {
        color: #666;
        font-size: 13px;
        margin-top: 5px;
    }
</style>
</head> <body> <div class="container"> <h1>Cookie 数据加密工具</h1> <p>上传您的 Netscape 格式 Cookie 文件，加密后可以安全分享。</p>
    <div class="file-input-section">
        <h2>选择 Cookie 文件</h2>
        <input type="file" id="cookieFileInput" accept=".txt">
        <p class="helper-text">请选择 Netscape 格式的 Cookie 文件</p>
        <button id="encryptButton">加密数据</button>
    </div>

    <div class="textarea-section" style="margin-top: 20px;">
        <h2>或直接粘贴 Cookie 数据</h2>
        <textarea id="cookieTextarea" placeholder="粘贴 Netscape 格式的 Cookie 数据..."></textarea>
    </div>

    <div class="result-section">
        <h2>加密结果</h2>
        <textarea id="resultTextarea" placeholder="加密后的数据会显示在这里..." readonly></textarea>
        <button id="copyButton">复制加密数据</button>
        <div id="successMessage" class="success-message">已成功复制到剪贴板！</div>
        <div id="errorMessage" class="error-message"></div>
    </div>

    <div class="instructions" style="margin-top: 30px;">
        <h2>使用说明</h2>
        <ol>
            <li>上传 Cookie 文件或粘贴 Cookie 数据</li>
            <li>点击"加密数据"按钮</li>
            <li>复制生成的加密数据</li>
            <li>在 Cookie 导入工具的解密选项中粘贴该数据</li>
        </ol>
    </div>
</div>

<script>
    document.addEventListener('DOMContentLoaded', function() {
        const cookieFileInput = document.getElementById('cookieFileInput');
        const cookieTextarea = document.getElementById('cookieTextarea');
        const encryptButton = document.getElementById('encryptButton');
        const resultTextarea = document.getElementById('resultTextarea');
        const copyButton = document.getElementById('copyButton');
        const successMessage = document.getElementById('successMessage');
        const errorMessage = document.getElementById('errorMessage');

        // 读取文件内容
        function readFile(file) {
            return new Promise((resolve, reject) => {
                const reader = new FileReader();
                
                reader.onload = (event) => {
                    resolve(event.target.result);
                };
                
                reader.onerror = (error) => {
                    reject(error);
                };
                
                reader.readAsText(file);
            });
        }

        // 加密函数
        async function encryptData(text, password = 'cookieImporterSecret') {
            // 使用 Web Crypto API
            const encoder = new TextEncoder();
            const data = encoder.encode(text);
            
            // 从密码生成密钥
            const keyMaterial = await window.crypto.subtle.importKey(
                'raw',
                encoder.encode(password),
                { name: 'PBKDF2' },
                false,
                ['deriveBits', 'deriveKey']
            );
            
            // 生成随机盐
            const salt = window.crypto.getRandomValues(new Uint8Array(16));
            
            // 派生AES密钥
            const key = await window.crypto.subtle.deriveKey(
                {
                    name: 'PBKDF2',
                    salt,
                    iterations: 100000,
                    hash: 'SHA-256'
                },
                keyMaterial,
                { name: 'AES-GCM', length: 256 },
                false,
                ['encrypt']
            );
            
            // 初始化向量
            const iv = window.crypto.getRandomValues(new Uint8Array(12));
            
            // 加密
            const encrypted = await window.crypto.subtle.encrypt(
                {
                    name: 'AES-GCM',
                    iv
                },
                key,
                data
            );
            
            // 将盐、iv和加密数据合并
            const result = new Uint8Array(salt.length + iv.length + encrypted.byteLength);
            result.set(salt, 0);
            result.set(iv, salt.length);
            result.set(new Uint8Array(encrypted), salt.length + iv.length);
            
            // 转换为base64
            return btoa(String.fromCharCode(...result));
        }

        // 当选择文件时自动填充文本框
        cookieFileInput.addEventListener('change', async () => {
            if (cookieFileInput.files.length > 0) {
                try {
                    cookieTextarea.value = await readFile(cookieFileInput.files[0]);
                } catch (error) {
                    console.error('读取文件失败:', error);
                    showError('读取文件失败: ' + error.message);
                }
            }
        });

        // 加密按钮点击事件
        encryptButton.addEventListener('click', async () => {
            const cookieData = cookieTextarea.value.trim();
            
            if (!cookieData) {
                showError('请先选择文件或输入Cookie数据');
                return;
            }
            
            try {
                const encryptedData = await encryptData(cookieData);
                resultTextarea.value = encryptedData;
            } catch (error) {
                console.error('加密失败:', error);
                showError('加密失败: ' + error.message);
            }
        });

        // 复制按钮点击事件
        copyButton.addEventListener('click', () => {
            if (!resultTextarea.value) {
                showError('没有可复制的数据');
                return;
            }
            
            resultTextarea.select();
            document.execCommand('copy');
            
            showSuccess();
        });

        function showError(message) {
            errorMessage.textContent = message;
            errorMessage.style.display = 'block';
            successMessage.style.display = 'none';
            
            setTimeout(() => {
                errorMessage.style.display = 'none';
            }, 3000);
        }

        function showSuccess() {
            successMessage.style.display = 'block';
            errorMessage.style.display = 'none';
            
            setTimeout(() => {
                successMessage.style.display = 'none';
            }, 3000);
        }
    });
</script> </body> </html>